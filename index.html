<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>International Currency Converter</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="description" content="Live International Currency Converter with INR support and exchange rate history">

<link rel="icon" href="logo.png">

<!-- AdSense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7360825692914290" crossorigin="anonymous"></script>

<!-- TomSelect -->
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

<style>
body{font-family:Segoe UI;margin:0;background:#f0fff4}
.container{max-width:900px;margin:auto;padding:20px}
.card{background:white;padding:20px;border-radius:16px;box-shadow:0 15px 40px rgba(0,0,0,.12)}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
button{background:#16a34a;color:white;border:none;padding:12px;border-radius:10px;font-weight:bold;cursor:pointer}
.swap{background:#065f46}
.result{margin-top:14px;background:#dcfce7;padding:14px;border-radius:12px;font-weight:bold}
.flag{width:18px;height:14px;margin-right:6px}
.favorite{cursor:pointer;color:#f59e0b;font-weight:bold}
</style>
</head>

<body>
<div class="container">
<div class="card">

<h2>International Currency Converter</h2>

<!-- AD ZONE A -->
<div style="text-align:center;margin:12px">Ad Space Top</div>

<div class="grid">
<input id="amount" type="number" value="1">

<select id="unit">
<option value="1">Normal</option>
<option value="1000">Thousand</option>
<option value="1000000">Million</option>
</select>

<select id="from"></select>
<select id="to"></select>

<button class="swap" onclick="swapCurrencies()">‚áÑ Swap</button>
<button onclick="convert()">Convert</button>
</div>

<div class="result" id="result"></div>

<!-- AD ZONE B -->
<div style="text-align:center;margin:12px">Ad Space Result</div>

<div id="change"></div>

<!-- AD ZONE C -->
<div style="text-align:center;margin:12px">Ad Space Bottom</div>

</div>
</div>

<script>
const POPULAR=["USD","INR","AED","EUR","GBP","SAR","QAR","KWD"];
let rates={}, yesterdayRates={};

const fromSel=document.getElementById("from");
const toSel=document.getElementById("to");

function flagURL(code){
 return "https://flagcdn.com/24x18/"+code.slice(0,2).toLowerCase()+".png";
}

function favs(){
 return JSON.parse(localStorage.getItem("favCurrencies")||"[]");
}

function toggleFav(c){
 let f=favs();
 if(f.includes(c)) f=f.filter(x=>x!==c);
 else f.push(c);
 localStorage.setItem("favCurrencies",JSON.stringify(f));
 buildSelects();
}

function optionHTML(c,name){
 const star=favs().includes(c)?"‚≠ê":"‚òÜ";
 return `<div>
 <img class="flag" src="${flagURL(c)}">
 ${c} ‚Äî ${name}
 <span class="favorite" onclick="event.stopPropagation();toggleFav('${c}')">${star}</span>
 </div>`;
}

async function loadRates(){
 const r=await fetch("https://open.er-api.com/v6/latest/USD");
 const d=await r.json();
 rates=d.rates;

 const y=await fetch("https://api.frankfurter.app/latest?from=USD");
 const yd=await y.json();
 yesterdayRates=yd.rates;

 buildSelects();
 autoDetectCurrency();
}

function buildSelects(){
 fromSel.innerHTML="";
 toSel.innerHTML="";

 const names=new Intl.DisplayNames(['en'],{type:'currency'});
 const all=Object.keys(rates).sort();
 const ordered=[...favs(),...POPULAR,...all.filter(x=>!POPULAR.includes(x)&&!favs().includes(x))];

 ordered.forEach(c=>{
  const name=names.of(c)||c;
  fromSel.innerHTML+=`<option value="${c}">${c} ‚Äî ${name}</option>`;
  toSel.innerHTML+=`<option value="${c}">${c} ‚Äî ${name}</option>`;
 });

 new TomSelect("#from",{render:{option:(d)=>optionHTML(d.value,d.text.split("‚Äî")[1]||d.value)}});
 new TomSelect("#to",{render:{option:(d)=>optionHTML(d.value,d.text.split("‚Äî")[1]||d.value)}});

 fromSel.value="USD";
 toSel.value="INR";
}

function swapCurrencies(){
 const a=fromSel.tomselect.getValue();
 const b=toSel.tomselect.getValue();
 fromSel.tomselect.setValue(b);
 toSel.tomselect.setValue(a);

 document.querySelector(".swap").animate(
  [{transform:"rotate(0deg)"},{transform:"rotate(180deg)"}],
  {duration:400}
 );
}

function convert(){
 const amt=amount.value*unit.value;
 const f=fromSel.tomselect.getValue();
 const t=toSel.tomselect.getValue();

 const val=(amt/rates[f])*rates[t];
 result.innerText=`${amt} ${f} = ${val.toFixed(2)} ${t}`;

 showChange(f,t);
}

function showChange(f,t){
 if(!yesterdayRates[f]||!yesterdayRates[t]) return;
 const today=rates[t]/rates[f];
 const yest=yesterdayRates[t]/yesterdayRates[f];
 const pct=((today-yest)/yest*100).toFixed(2);
 change.innerHTML = pct>0
  ? `üìà Rate up ${pct}%`
  : `üìâ Rate down ${pct}%`;
}

async function autoDetectCurrency(){
 try{
  const r=await fetch("https://ipapi.co/json/");
  const j=await r.json();
  if(j.currency && rates[j.currency]){
   fromSel.tomselect.setValue(j.currency);
  }
 }catch{}
}

loadRates();
</script>

</body>
</html>
